---
title: "Project"
output:
  html_document: default
  pdf_document: default
date: "2022-11-06"
---

```{r}
options(repos = list(CRAN="http://cran.rstudio.com/"))

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages('plyr', repos = "http://cran.us.r-project.org")

install.packages("tidyverse")  
install.packages("scales")
install.packages("stringr")
install.packages("ggthemes") 
```

```{r}
install.packages("plotly", type = "source")
library("plotly")
library("tidyverse") 
library("scales") 
library("stringr") 
library("ggthemes") 
```

```{r}

bank <- read.csv("C:/Fall2022/DPA/Project/bank/bank-full.csv", stringsAsFactors = FALSE,header = TRUE, sep = ';')

```

```{r}
summary(bank)
```

```{r}
options(knitr.duplicate.label = "allow")
```
# yes and output analysis
```{r}
bank %>% 
  count(y) %>% 
  mutate(perc = n / nrow(bank)) -> predictorData2

ggplot(predictorData2, aes(x = y, y = perc)) + geom_bar(stat = "identity")
```

# Job type analysis

```{r name-of-chunk1, fig.width=10, fig.height=4}
bank %>% 
  count(job) %>% 
  mutate(perc = n / nrow(bank)) -> bank3

ggplot(bank3, aes(x = job, y = perc)) + geom_bar(stat = "identity")


```

# Job type analysis with output field

```{r name-of-chunk2, fig.width=15, fig.height=7}
ggplot(bank, 
       aes(x = job,
           fill = y)) + 
   geom_bar(position = "dodge")
```
# marrital type analysis


```{r name-of-chunk3, fig.width=10, fig.height=4}
bank %>% 
  count(marital) %>% 
  mutate(perc = n / nrow(bank)) -> bank3

ggplot(bank3, aes(x = marital, y = perc)) + geom_bar(stat = "identity")


```

# marrital type analysis with output field

```{r name-of-chunk4, fig.width=15, fig.height=7}
ggplot(bank, 
       aes(x = marital,
           fill = y)) + 
   geom_bar(position = "dodge")
```

# defaulter by bank field analysis 

```{r name-of-chunk5, fig.width=10, fig.height=4}
bank %>% 
  count(default) %>% 
  mutate(perc = n / nrow(bank)) -> bank3

ggplot(bank3, aes(x = default, y = perc)) + geom_bar(stat = "identity")


```
# defaulter by bank analysis with output field

```{r name-of-chunk6, fig.width=15, fig.height=7}
ggplot(bank, 
       aes(x = default,
           fill = y)) + 
   geom_bar(position = "dodge")
```

# housing field analysis 

```{r name-of-chunk7, fig.width=10, fig.height=4}
bank %>% 
  count(housing) %>% 
  mutate(perc = n / nrow(bank)) -> bank3

ggplot(bank3, aes(x = housing, y = perc)) + geom_bar(stat = "identity")


```
# housing field analysis  with output field
```{r name-of-chunk21, fig.width=15, fig.height=7}
ggplot(bank, 
       aes(x = housing,
           fill = y)) + 
   geom_bar(position = "dodge")
```



# previous marketing outcome analysis
```{r name-of-chunk12, fig.width=10, fig.height=4}
bank %>% 
  count(poutcome) %>% 
  mutate(perc = n / nrow(bank)) -> bank3

ggplot(bank3, aes(x = poutcome, y = perc)) + geom_bar(stat = "identity")


```
# previous marketing outcome  analysis with output field
```{r name-of-chunk19, fig.width=15, fig.height=7}
ggplot(bank, 
       aes(x = poutcome,
           fill = y)) + 
   geom_bar(position = "dodge")
```

# Month fiels analysis shows in which month bank contact more with customers
# Month Note- day of the week is required calculation and its not useful data as usually in any banking sector performance is calculated monthly and quartely or yearly. 



```{r name-of-chunk15, fig.width=10, fig.height=4}




bank %>% 
  count(month) %>% 
  mutate(perc = n / nrow(bank),Month = factor(month, levels = c("jan", "feb", "mar", "apr", "may", "jun", 
               "jul", "aug", "sep", "oct", "nov", "dec"))) -> bank3

ggplot(bank3, aes(x = Month, y = perc)) + geom_bar(stat = "identity")


```

# Month fiels analysis shows in which month bank contact more with customers with output fields
```{r name-of-chunk8, fig.width=15, fig.height=7}

bankMutate <- bank %>%
  mutate(Month = factor(month, levels = c("jan", "feb", "mar", "apr", "may", "jun", 
               "jul", "aug", "sep", "oct", "nov", "dec")))

ggplot(bankMutate, 
       aes(x = Month,
           fill = y)) + 
   geom_bar(position = "dodge")
```
# Age fieled analysis to identify age group which is contacted more by banks.

```{r name-of-chunk17, fig.width=10, fig.height=4}


bank$AgeGroup <- cut(bank$age, 
                         breaks = c(-Inf,
                                    10,20,30,40,50,60,70,80,90,100
                                    , Inf), 
                         
                         labels = c("0-9 "
                                    ,"10-19 ","20-29","30-39","40-49"
                                    ,"50-59","60-69","70-79","80-89"
                                    ,"90-100","100 +"),
                         right = FALSE)


bank %>% 
  count(AgeGroup) %>% 
  mutate(perc = n / nrow(bank)) -> bank3

ggplot(bank3, aes(x = AgeGroup, y = perc)) + geom_bar(stat = "identity")


```
# Age fieled analysis to identify age group which is contacted more by banks with output fields
```{r name-of-chunk18, fig.width=15, fig.height=7}
ggplot(bank, 
       aes(x = AgeGroup,
           fill = y)) + 
   geom_bar(position = "dodge")
```


# call duration analysis


```{r}
ggplot_duration<- ggplotly(ggplot(bank, aes(x=as.factor(y), y=duration)) +
                             geom_boxplot(fill='#A4A4A4', color="black")+
                             theme_classic())
ggplot_duration
```

```{r}
head(bank)
```

